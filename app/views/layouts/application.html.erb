<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="SNSアプリケーション - つながる、シェアする、発見する">
    <title><%= content_for?(:title) ? yield(:title) + " | SNSアプリケーション" : "SNSアプリケーション" %></title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js" defer></script>
    <%= javascript_importmap_tags %>
    
    <script>
      // サービスワーカーの登録
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js')
            .then(registration => {
              console.log('ServiceWorker registration successful');
            })
            .catch(error => {
              console.log('ServiceWorker registration failed:', error);
            });
        });
      }
    </script>
  </head>

  <body class="bg-gray-50 min-h-screen flex flex-col">
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:p-4 focus:bg-blue-500 focus:text-white focus:z-50">
      メインコンテンツにスキップ
    </a>
    
    <%= render 'shared/navigation' %>
    
    <div class="container mx-auto px-4 py-4">
      <% if notice %>
        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert" aria-live="polite">
          <span class="block sm:inline"><%= notice %></span>
        </div>
      <% end %>
      <% if alert %>
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert" aria-live="assertive">
          <span class="block sm:inline"><%= alert %></span>
        </div>
      <% end %>
    </div>

    <main id="main-content" class="flex-grow">
      <%= yield %>
    </main>
    
    <footer class="bg-white border-t mt-auto py-4">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <p class="text-center text-gray-500 text-sm">
          &copy; <%= Date.today.year %> SNSアプリケーション
        </p>
      </div>
    </footer>
  </body>
</html>
